<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŒ«çœ¼ç”µå½±TOP100æ•°æ®åˆ†æ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-4 mb-2">çŒ«çœ¼ç”µå½±TOP100æ•°æ®åˆ†ææŠ¥å‘Š</h1>
                    <p class="lead mb-0">åŸºäºçŒ«çœ¼ç”µå½±TOP100æ¦œå•çš„æ·±åº¦æ•°æ®å¯è§†åŒ–åˆ†æ</p>
                </div>
                <div class="col-md-4 text-end">
                    <div class="text-light">æ•°æ®æ›´æ–°æ—¶é—´: <span id="update-time">2024å¹´1æœˆ</span></div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- æ•°æ®æ¦‚è§ˆå¡ç‰‡ -->
        <h2 class="section-title">æ•°æ®æ¦‚è§ˆ</h2>
        <div class="row" id="stats-cards"></div>

        <!-- æ ¸å¿ƒåˆ†æå›¾è¡¨ -->
        <div class="row">
            <div class="col-md-6">
                <h3 class="section-title">å¹´ä»£åˆ†å¸ƒåˆ†æ</h3>
                <div class="chart-container" id="decade-chart"></div>
            </div>
            <div class="col-md-6">
                <h3 class="section-title">è¯„åˆ†åˆ†å¸ƒåˆ†æ</h3>
                <div class="chart-container" id="rating-chart"></div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <h3 class="section-title">åœ°åŸŸåˆ†å¸ƒåˆ†æ</h3>
                <div class="chart-container" id="region-chart"></div>
            </div>
            <div class="col-md-6">
                <h3 class="section-title">æ¼”å‘˜å½±å“åŠ›åˆ†æ</h3>
                <div class="chart-container" id="actor-chart"></div>
            </div>
        </div>

        <!-- TOP10æ’è¡Œæ¦œ -->
        <h2 class="section-title">TOP10ç”µå½±æ’è¡Œæ¦œ</h2>
        <div class="chart-container" id="top10-chart"></div>

        <!-- å®Œæ•´æ•°æ®è¡¨æ ¼ -->
        <h2 class="section-title">å®Œæ•´æ•°æ®æµè§ˆ</h2>
        <input type="text" class="form-control search-box" placeholder="ğŸ” æœç´¢ç”µå½±åç§°ã€æ¼”å‘˜..." id="search-input">
        <div class="table-container">
            <table class="table table-hover" id="movie-table">
                <thead>
                    <tr>
                        <th>æ’å</th>
                        <th>ç”µå½±åç§°</th>
                        <th>è¯„åˆ†</th>
                        <th>ä¸»æ¼”</th>
                        <th>ä¸Šæ˜ å¹´ä»½</th>
                        <th>åœ°åŒº</th>
                    </tr>
                </thead>
                <tbody id="movie-table-body"></tbody>
            </table>
        </div>
    </div>

    <footer class="footer">
        <div class="container text-center">
            <p>æ•°æ®æ¥æºï¼šçŒ«çœ¼ç”µå½±TOP100 | åˆ†æå·¥å…·ï¼šPython + ECharts | ä»…ä¾›å­¦ä¹ ä½¿ç”¨</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="data.js"></script>
    <script>
        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
        document.addEventListener('DOMContentLoaded', function() {
            initStatsCards();
            initDecadeChart();
            initRatingChart();
            initRegionChart();
            initActorChart();
            initTop10Chart();
            initDataTable();
            
            document.getElementById('update-time').textContent = new Date().toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: 'long'
            });
        });

        function initStatsCards() {
            const stats = movieData.stats;
            const cardsContainer = document.getElementById('stats-cards');
            
            const cards = [
                { number: stats.total, label: 'æ€»ç”µå½±æ•°', icon: 'ğŸ¬' },
                { number: stats.avgRating, label: 'å¹³å‡è¯„åˆ†', icon: 'â­' },
                { number: stats.yearRange, label: 'å¹´ä»£è·¨åº¦', icon: 'ğŸ“…' },
                { number: stats.completeness, label: 'æ•°æ®å®Œæ•´åº¦', icon: 'âœ…' }
            ];
            
            cardsContainer.innerHTML = cards.map(card => `
                <div class="col-md-3">
                    <div class="stat-card text-center">
                        <div class="stat-number">${card.icon} ${card.number}</div>
                        <div class="stat-label">${card.label}</div>
                    </div>
                </div>
            `).join('');
        }

        function initDecadeChart() {
            const chart = echarts.init(document.getElementById('decade-chart'));
            const option = {
                tooltip: { trigger: 'axis' },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: { type: 'category', data: movieData.decades.map(item => item.name) },
                yAxis: { type: 'value' },
                series: [{
                    data: movieData.decades.map(item => ({ value: item.value })),
                    type: 'bar',
                    barWidth: '60%',
                    itemStyle: {
                        borderRadius: [4, 4, 0, 0],
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: '#2a5298' }, { offset: 1, color: '#1e3c72' }
                        ])
                    },
                    label: { show: true, position: 'top', formatter: '{c}éƒ¨' }
                }]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        function initRatingChart() {
            const chart = echarts.init(document.getElementById('rating-chart'));
            const option = {
                tooltip: { trigger: 'item', formatter: '{b}: {c}éƒ¨ ({d}%)' },
                legend: { orient: 'vertical', right: 10, top: 'center' },
                series: [{
                    name: 'è¯„åˆ†åˆ†å¸ƒ',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    data: movieData.ratings.map((item, index) => ({
                        value: item.value, name: item.name,
                        itemStyle: { color: ['#e74c3c', '#3498db', '#2ecc71', '#f39c12'][index] }
                    })),
                    emphasis: { label: { show: true, fontSize: '18', fontWeight: 'bold' } },
                    labelLine: { show: false }
                }]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        function initRegionChart() {
            const chart = echarts.init(document.getElementById('region-chart'));
            const option = {
                tooltip: { trigger: 'item', formatter: '{b}: {c}éƒ¨ ({d}%)' },
                legend: { bottom: '5%', left: 'center' },
                series: [{
                    name: 'åœ°åŸŸåˆ†å¸ƒ',
                    type: 'pie',
                    radius: '70%',
                    center: ['50%', '45%'],
                    data: movieData.regions.map((item, index) => ({
                        value: item.value, name: item.name,
                        itemStyle: { color: ['#e74c3c', '#3498db', '#2ecc71', '#f39c12'][index] }
                    })),
                    label: { formatter: '{b}\n{d}%' }
                }]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        function initActorChart() {
            const chart = echarts.init(document.getElementById('actor-chart'));
            const topActors = movieData.actors.slice(0, 10);
            const option = {
                tooltip: { trigger: 'axis' },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: { type: 'value' },
                yAxis: { type: 'category', data: topActors.map(item => item.name).reverse() },
                series: [{
                    name: 'å‡ºæ¼”ç”µå½±æ•°é‡',
                    type: 'bar',
                    data: topActors.map(item => ({ value: item.value })).reverse(),
                    label: { show: true, position: 'right', formatter: '{c}éƒ¨' }
                }]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        function initTop10Chart() {
            const chart = echarts.init(document.getElementById('top10-chart'));
            const option = {
                tooltip: { trigger: 'axis' },
                grid: { left: '3%', right: '4%', bottom: '3%', top: '3%', containLabel: true },
                xAxis: { type: 'value', max: 10, axisLabel: { formatter: '{value}åˆ†' } },
                yAxis: { type: 'category', data: movieData.top10.map(item => item.name).reverse() },
                series: [{
                    name: 'è¯„åˆ†',
                    type: 'bar',
                    data: movieData.top10.map(item => ({ value: item.rating })).reverse(),
                    label: { show: true, position: 'right', formatter: '{c}åˆ†' }
                }]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        function initDataTable() {
            const tableBody = document.getElementById('movie-table-body');
            const searchInput = document.getElementById('search-input');
            
            function renderTable(movies) {
                tableBody.innerHTML = movies.map(movie => `
                    <tr>
                        <td><span class="highlight">${movie.rank}</span></td>
                        <td>${movie.name}</td>
                        <td><span class="highlight">${movie.rating}</span></td>
                        <td>${movie.actors}</td>
                        <td>${movie.year}</td>
                        <td>${movie.region}</td>
                    </tr>
                `).join('');
            }
            
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const filteredMovies = movieData.movies.filter(movie => 
                    movie.name.toLowerCase().includes(searchTerm) ||
                    movie.actors.toLowerCase().includes(searchTerm)
                );
                renderTable(filteredMovies);
            });
            
            renderTable(movieData.movies);
        }
    </script>
</body>
</html>